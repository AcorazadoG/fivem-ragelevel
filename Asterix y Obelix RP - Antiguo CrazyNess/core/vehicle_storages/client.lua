local veh_inventory = {}local veh_weapons = {}local vehicle_plate = nillocal veh_cash = {}local maxCapacity = {  [0] = {["item"] = 50, ["weapons"] = 2}, --Compact  [1] = {["item"] = 60, ["weapons"] = 2}, --Sedan  [2] = {["item"] = 100, ["weapons"] = 3}, --SUV  [3] = {["item"] = 60, ["weapons"] = 2}, --Coupes  [4] = {["item"] = 70, ["weapons"] = 2}, --Muscle  [5] = {["item"] = 60, ["weapons"] = 2}, --Sports Classics  [6] = {["item"] = 50, ["weapons"] = 2}, --Sports  [7] = {["item"] = 30, ["weapons"] = 2}, --Super  [8] = {["item"] = 15, ["weapons"] = 1}, --Motorcycles  [9] = {["item"] = 40, ["weapons"] = 2}, --Off-road  [10] = {["item"] = 400, ["weapons"] = 8}, --Industrial  [11] = {["item"] = 25, ["weapons"] = 1}, --Utility  [12] = {["item"] = 200, ["weapons"] = 6}, --Vans  [14] = {["item"] = 0, ["weapons"] = 1}, --Boats  [15] = {["item"] = 0, ["weapons"] = 1}, --Helicopters  [16] = {["item"] = 0, ["weapons"] = 1}, --Planes  [17] = {["item"] = 40, ["weapons"] = 1}, --Service  [18] = {["item"] = 40, ["weapons"] = 2}, --Emergency  [20] = {["item"] = 250, ["weapons"] = 2}, --Commercial}local fastResponse = {  [1] = {id = "FBI"},  [2] = {id = "POLICE2"},  [3] = {id = "FBI2"},  [4] = {id = "POLICE8"},  [5] = {id = "POLICE"},  [6] = {id = "POLICE3"},  [7] = {id = "POLICE4"},  [8] = {id = "RIOT"},}RegisterNetEvent('vehicle_inventory:updateitems')AddEventHandler('vehicle_inventory:updateitems', function(inv, weapons) veh_inventory = {} veh_weapons = {} veh_inventory = inv veh_weapons = weapons veh_cash = cashend)function VehicleInFront() local pos = GetEntityCoords(GetPlayerPed(-1)) local entityWorld = GetOffsetFromEntityInWorldCoords(GetPlayerPed(-1), 0.0, 4.0, 0.0) local rayHandle = CastRayPointToPoint(pos.x, pos.y, pos.z, entityWorld.x, entityWorld.y, entityWorld.z, 10, GetPlayerPed(-1), 0) local a, b, c, d, result = GetRaycastResult(rayHandle)  return result endCitizen.CreateThread(function() while true do  Wait(5)  if IsControlJustPressed(0, 182) and not IsPedInAnyVehicle(GetPlayerPed(-1), false) then   PDtrunk = false   local vehFront = VehicleInFront()   local x,y,z = table.unpack(GetEntityCoords(GetPlayerPed(-1),true))   local vehicle = GetClosestVehicle(x, y, z, 4.0, 0, 71)   if vehFront > 0 and vehicle ~= nil then    if GetVehicleDoorLockStatus(vehicle) == 1 then      local t, distance = GetClosestPlayer()      if(distance ~= -1 and distance < 6) then       exports['clrp_notify']:DoHudText('error', 'Jugador cercano, diles que retrocedan')      else        for k,v in pairs(fastResponse) do          SetVehicleDoorOpen(vehFront, 5, false, false)          vehicle_plate = GetVehicleNumberPlateText(vehFront)          TriggerServerEvent("vehicle_inventory:getInventory", GetVehicleNumberPlateText(vehFront))          TriggerEvent("vehicle_inventory:settype", GetVehicleClass(vehFront))		  -- WarMenu.OpenMenu('vehicle_inventory')        end       end    else     exports['clrp_notify']:DoHudText('error', 'Vehículo bloqueado')    end   else    vehicle_plate = nil    exports['clrp_notify']:DoHudText('error', 'No hay vehículo cerca')   end  end endend) Citizen.CreateThread(function() local currentstore = 1 local selectedstore = 1 local currenttake = 1  local selectedtake = 1 WarMenu.CreateMenu('vehicle_inventory', 'Trunk') WarMenu.CreateSubMenu('storage_depsoit', 'Trunk') WarMenu.CreateSubMenu('storage_depsoit', 'vehicle_inventory', 'storage_depsoit') WarMenu.CreateSubMenu('trunk_listitems', 'vehicle_inventory', 'trunk_listitems') WarMenu.CreateSubMenu('trunk_storeweapons', 'vehicle_inventory', 'trunk_storeweapons') WarMenu.CreateSubMenu('trunk_listweapons', 'vehicle_inventory', 'trunk_listweapons') while true do  Citizen.Wait(5)  if WarMenu.IsMenuOpened('vehicle_inventory') then   if WarMenu.ComboBox('Store', {'Items', 'Weapons', 'Cash', 'Dirty Cash'}, currentstore, selectedstore, function(store)     currentstore = store     selectedstore = currentstore    end) then    if selectedstore == 1 then WarMenu.OpenMenu('storage_depsoit') elseif selectedstore == 2 then WarMenu.OpenMenu('trunk_storeweapons') elseif selectedstore == 3 then storeCash(1) elseif selectedstore == 4 then storeCash(2) end    elseif WarMenu.ComboBox('Take', {'Items', 'Weapons', 'Cash', 'Dirty Cash'}, currenttake, selectedtake, function(take)     currenttake = take     selectedtake = currenttake    end) then    if selectedtake == 1 then WarMenu.OpenMenu('trunk_listitems') elseif selectedtake == 2 then WarMenu.OpenMenu('trunk_listweapons') elseif selectedtake == 3 then takeCash(1) elseif selectedtake == 4 then takeCash(2) end    elseif WarMenu.Button('Close Trunk') then    SetVehicleDoorShut(VehicleInFront(), 5, false)    DecorSetBool(VehicleInFront(), "Trunk", false)   end   WarMenu.Display()  elseif WarMenu.IsMenuOpened('storage_depsoit') then   local inventory = getInventory()   for i = 1,#inventory do    if (inventory[i].q > 0) then     if WarMenu.Button(tostring(inventory[i].name), tonumber(inventory[i].q)) then      local t, distance = GetClosestPlayer()      if(distance ~= -1 and distance < 6) then       exports.pNotify:SendNotification({text = "Player Near, Tell Them To Move Back"})      else       VehicleItemStore(inventory[i].id, inventory[i].name, inventory[i].q)       end     end    end   end   WarMenu.Display()  elseif WarMenu.IsMenuOpened('trunk_listitems') then   for i = 1,#veh_inventory do    if (veh_inventory[i].q > 0) then     if WarMenu.Button(veh_inventory[i].name, veh_inventory[i].q) then      local t, distance = GetClosestPlayer()      if(distance ~= -1 and distance < 6) then       exports.pNotify:SendNotification({text = "Player Near, Tell Them To Move Back"})      else       VehicleItemTake(veh_inventory[i].item, veh_inventory[i].q, veh_inventory[i].meta)      end     end    end   end   WarMenu.Display()  elseif WarMenu.IsMenuOpened('trunk_storeweapons') then   local inventory = getWeapons()   for i = 1,#inventory do    if WarMenu.Button(tostring(inventory[i].label)) then     if 1 + getVehicleWeapons() <= maxCapacity[GetVehicleClass(VehicleInFront())].weapons then      RemoveWeaponFromPed(PlayerPedId(), GetHashKey(inventory[i].name))      TriggerServerEvent('vehicle_inventory:addweapon', vehicle_plate, inventory[i].name, inventory[i].label, inventory[i].id, inventory[i].blackmarket)     else      exports.pNotify:SendNotification({text = "Vehicle Can Only Hold "..maxCapacity[GetVehicleClass(VehicleInFront())].weapons.." Weapons"})     end    end   end   WarMenu.Display()  elseif WarMenu.IsMenuOpened('trunk_listweapons') then   for i = 1,#veh_weapons do    if WarMenu.Button(tostring(veh_weapons[i].label)) then     TriggerServerEvent('vehicle_inventory:removeweapon', vehicle_plate, veh_weapons[i].name, veh_weapons[i].id, veh_weapons[i].label, veh_weapons[i].weapon_id, veh_weapons[i].blackmarket)    end   end   WarMenu.Display()  else  Citizen.Wait(500)  end endend)function VehicleItemStore(item, name, quantity) local amount = "xxsdrtghyuujhdjsjenenfjfjtjtjtj" if(amount == "xxsdrtghyuujhdjsjenenfjfjtjtjtj") then  showLoadingPrompt("Enter Quantity", 3)  DisplayOnscreenKeyboard(1, "FMMC_KEY_TIP8S", "", "", "", "", "", 20)  while (UpdateOnscreenKeyboard() == 0) do   DisableAllControlActions(0);   Wait(0);  end  if (GetOnscreenKeyboardResult()) then   local option = tonumber(GetOnscreenKeyboardResult())   if(option ~= nil and option ~= 0) then    amount = ""..option   end  end end stopLoadingPrompt() if (amount ~= "xxsdrtghyuujhdjsjenenfjfjtjtjtj" and tonumber(amount) > 0) then  if amount + getVehicleQuantity() <= maxCapacity[GetVehicleClass(VehicleInFront())].item then   TriggerServerEvent('vehicle_inventory:additems', vehicle_plate, item, name, amount)  else   exports.pNotify:SendNotification({text = "Vehicle Can Only Hold "..maxCapacity[GetVehicleClass(VehicleInFront())].item.." Items"})  end endendfunction VehicleItemTake(item, qty, meta) local amount = "xxsdrtghyuujhdjsjenenfjfjtjtjtj" if(amount == "xxsdrtghyuujhdjsjenenfjfjtjtjtj") then  showLoadingPrompt("Enter Quantity", 3)  DisplayOnscreenKeyboard(1, "FMMC_KEY_TIP8S", "", "", "", "", "", 20)  while (UpdateOnscreenKeyboard() == 0) do   DisableAllControlActions(0);   Wait(0);  end  if (GetOnscreenKeyboardResult()) then   local option = tonumber(GetOnscreenKeyboardResult())   if(option ~= nil and option ~= 0) then    amount = ""..option   end  end end stopLoadingPrompt() if (amount ~= "xxsdrtghyuujhdjsjenenfjfjtjtjtj" and tonumber(amount) > 0) then  if math.floor(getQuantity() + amount) <= 120 then   if tonumber(amount) <= tonumber(qty) then     TriggerServerEvent('vehicle_inventory:removeitems', vehicle_plate, item, amount, meta)   end   else   exports.pNotify:SendNotification({text = "Inventory Full"})  end endendfunction getVehicleQuantity() local quantity = 0 for i=1,#veh_inventory do  quantity = quantity + veh_inventory[i].q end return quantityendfunction getVehicleWeapons() local quantity = 0 for i=1,#veh_weapons do  quantity = quantity + 1 end return quantityendfunction GetClosestPlayer()    local players = GetPlayers()    local closestDistance = -1    local closestPlayer = -1    local ply = GetPlayerPed(-1)    local plyCoords = GetEntityCoords(ply, 0)        for index,value in ipairs(players) do        local target = GetPlayerPed(value)        if(target ~= ply) then            local targetCoords = GetEntityCoords(GetPlayerPed(value), 0)            local distance = Vdist(targetCoords["x"], targetCoords["y"], targetCoords["z"], plyCoords["x"], plyCoords["y"], plyCoords["z"])            if(closestDistance == -1 or closestDistance > distance) then                closestPlayer = value                closestDistance = distance            end        end    end        return closestPlayer, closestDistanceendfunction GetPlayers()    local players = {}    for i = 0, 256 do        if NetworkIsPlayerActive(i) then            table.insert(players, i)        end    end    return playersendfunction storeCash(type) local amount = "xxsdrtghyuujhdjsjenenfjfjtjtjtj" if(amount == "xxsdrtghyuujhdjsjenenfjfjtjtjtj") then  showLoadingPrompt("Enter Amount", 3)  DisplayOnscreenKeyboard(1, "FMMC_KEY_TIP8S", "", "", "", "", "", 20)  while (UpdateOnscreenKeyboard() == 0) do   DisableAllControlActions(0);   Wait(0);  end  if (GetOnscreenKeyboardResult()) then   local option = tonumber(GetOnscreenKeyboardResult())   if(option ~= nil and option ~= 0) then    amount = ""..option   end  end end stopLoadingPrompt() if (amount ~= "xxsdrtghyuujhdjsjenenfjfjtjtjtj" and tonumber(amount) > 0) then  if veh_cash ~= nil and veh_cash[type] ~= nil then   if math.floor(veh_cash[type] + tonumber(amount)) <= 150000 then     TriggerServerEvent('vehicle_inventory:storecash', vehicle_plate, type, tonumber(amount))   else    exports.pNotify:SendNotification({text = "Vehicle Can Only Hold $150k"})   end  else   if tonumber(amount) <= 150000 then     TriggerServerEvent('vehicle_inventory:storecash', vehicle_plate, type, tonumber(amount))   else    exports.pNotify:SendNotification({text = "Vehicle Can Only Hold $150k"})   end  end endendfunction takeCash(type) local amount = "xxsdrtghyuujhdjsjenenfjfjtjtjtj" if(amount == "xxsdrtghyuujhdjsjenenfjfjtjtjtj") then  showLoadingPrompt("Enter Amount", 3)  DisplayOnscreenKeyboard(1, "FMMC_KEY_TIP8S", "", "", "", "", "", 20)  while (UpdateOnscreenKeyboard() == 0) do   DisableAllControlActions(0);   Wait(0);  end  if (GetOnscreenKeyboardResult()) then   local option = tonumber(GetOnscreenKeyboardResult())   if(option ~= nil and option ~= 0) then    amount = ""..option   end  end end stopLoadingPrompt() if (amount ~= "xxsdrtghyuujhdjsjenenfjfjtjtjtj" and tonumber(amount) > 0) then  TriggerServerEvent('vehicle_inventory:takecash', vehicle_plate, type, tonumber(amount)) endend